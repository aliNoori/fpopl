import{e as b,l as g,h as f,r as w,m as I,c as m,a as o,d as l,t as S,k as A,F as N,j as $,g as B,o as v,_ as C}from"./BGyzc9Ff.js";const j={class:"container"},q={class:"content"},E={class:"description"},F={class:"phone-number"},P={class:"input-container"},R=["onInput"],T=b({__name:"verify",setup(V){const u=g(),c=B(),i=I(),y=f().$axios,a=w(["","","",""]),_=i.query.phone,k=i.query.country,p=f().$toPersian;async function x(d,e){const s=d.target,n=s.value.replace(/[^0-9]/g,"");if(n){a.value[e]=n,s.value=p(n);const t=s.nextElementSibling;t&&t.focus()}if(a.value.every(t=>t!==""))try{const t=a.value.join(""),r=await y.post("/auth/verify-code",{code:t,phone:_,country:k});switch(r.status){case 200:console.log("کاربر از قبل وجود دارد:",r.data.user),alert("کاربر از قبل وجود دارد. خوش آمدید!"),await c.push("/");break;case 201:console.log("کاربر جدید با موفقیت ایجاد شد");const h=r.data.token;u.setToken(h),localStorage.setItem("auth_token",u.token),await c.push("/welcome");break;case 422:console.error("کد نامعتبر یا منقضی شده است"),alert("کد نامعتبر یا منقضی شده است. لطفاً دوباره تلاش کنید.");break;default:console.error("پاسخ غیرمنتظره:",r),alert("خطایی رخ داده است. لطفاً بعداً تلاش کنید.")}}catch(t){if(t.response)switch(t.response.status){case 409:console.error("تعارض: کاربر از قبل وجود دارد"),alert("کاربر از قبل وجود دارد!");break;default:console.error("خطا در فرایند تأیید:",t),alert("خطایی رخ داده است. لطفاً بعداً تلاش کنید.")}else console.error("خطای شبکه یا سرور:",t),alert("اتصال به سرور برقرار نشد. لطفاً اینترنت خود را بررسی کنید.")}}return(d,e)=>(v(),m("div",j,[o("div",q,[e[4]||(e[4]=o("h2",{class:"title"},"کد تایید",-1)),o("p",E,[e[0]||(e[0]=l(" لطفا کد ارسال شده به")),e[1]||(e[1]=o("br",null,null,-1)),e[2]||(e[2]=l(" شماره موبایل ")),o("span",F,S(A(p)("9355851170")),1),e[3]||(e[3]=l(" را وارد کنید "))]),o("div",P,[(v(),m(N,null,$(4,s=>o("input",{key:s,maxlength:"1",class:"input-field",type:"text",inputmode:"numeric",autocomplete:"off",onInput:n=>x(n,s-1)},null,40,R)),64))]),e[5]||(e[5]=o("p",{class:"timer"},"۱:۴۷ مانده تا دریافت مجدد",-1))])]))}}),z=C(T,[["__scopeId","data-v-bbf1361f"]]);export{z as default};
